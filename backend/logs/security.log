{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T11:52:28.755Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"hadirhimi9@gmail.com","level":"info","message":"user_register","userId":1}
{"duration_ms":246,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/register","status":201}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":20,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":11,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"202211187@ua.edu.lb","level":"info","message":"user_register","userId":2}
{"duration_ms":258,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/register","status":201}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"info","message":"logout","userId":2}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T16:57:04.285Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T16:57:31.063Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T16:58:27.044Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T16:58:37.109Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T16:58:37.295Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:00:07.321Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:00:19.060Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:01:56.978Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"warn","message":"login_failed","reason":"user_not_found"}
{"duration_ms":14,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":401}
{"email":"admin@example.com","level":"warn","message":"login_failed","reason":"user_not_found"}
{"duration_ms":11,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":401}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:02:46.977Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"warn","message":"login_failed","reason":"user_not_found"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":401}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:04:42.439Z"}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"info","message":"login_success","userId":3}
{"duration_ms":259,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:07:54.736Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:09:21.883Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:09:27.651Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:12:58.605Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:14:37.422Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:14:37.655Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:14:38.155Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"info","message":"login_success","userId":3}
{"duration_ms":253,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:19:10.472Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:21:23.541Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:32:02.600Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:41:47.650Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:42:15.895Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:42:18.649Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:45:31.353Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:50:52.800Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T17:57:48.148Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:03:35.995Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"info","message":"login_success","userId":3}
{"duration_ms":253,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: table posts has no column named status","method":"POST","path":"/api/posts","stack":"Error: SQLITE_ERROR: table posts has no column named status"}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error SQLITE_ERROR: table posts has no column named status","method":"POST","path":"/api/posts","stack":"Error: SQLITE_ERROR: table posts has no column named status"}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error File too large","method":"POST","path":"/api/files/upload","stack":"MulterError: File too large\n    at abortWithCode (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:73:22)\n    at FileStream.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:136:11)\n    at FileStream.emit (node:events:508:28)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:479:32)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Multipart.Writable.write (node:internal/streams/writable:508:10)"}
{"duration_ms":52,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/files/upload","status":500}
{"level":"info","message":"logout","userId":3}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:09:51.425Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:19:32.786Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:34:58.117Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:34:58.384Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"email":"admin@example.com","level":"info","message":"login_success","userId":3}
{"duration_ms":251,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts/pending","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'pending' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:102:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at /Users/user/Desktop/Security/backend/src/middleware/auth.ts:77:5\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":13,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts/pending","status":500}
{"duration_ms":12,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts/pending","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'pending' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:102:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at /Users/user/Desktop/Security/backend/src/middleware/auth.ts:77:5\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts/pending","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error File too large","method":"POST","path":"/api/posts","stack":"MulterError: File too large\n    at abortWithCode (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:73:22)\n    at FileStream.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:136:11)\n    at FileStream.emit (node:events:508:28)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:479:32)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Multipart.Writable.write (node:internal/streams/writable:508:10)"}
{"duration_ms":35,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error File too large","method":"POST","path":"/api/posts","stack":"MulterError: File too large\n    at abortWithCode (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:73:22)\n    at FileStream.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:136:11)\n    at FileStream.emit (node:events:508:28)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:479:32)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Multipart.Writable.write (node:internal/streams/writable:508:10)"}
{"duration_ms":37,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error File too large","method":"POST","path":"/api/posts","stack":"MulterError: File too large\n    at abortWithCode (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:73:22)\n    at FileStream.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:136:11)\n    at FileStream.emit (node:events:508:28)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:479:32)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Multipart.Writable.write (node:internal/streams/writable:508:10)"}
{"duration_ms":23,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts/pending","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'pending' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:102:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at /Users/user/Desktop/Security/backend/src/middleware/auth.ts:77:5\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts/pending","status":500}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts/pending","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'pending' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:102:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at /Users/user/Desktop/Security/backend/src/middleware/auth.ts:77:5\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts/pending","status":500}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"info","message":"logout","userId":3}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/login","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/login","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/register","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/register","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:42:41.578Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:44:52.519Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T18:56:57.835Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":5}
{"duration_ms":250,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_verified","userId":5}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error File too large","method":"POST","path":"/api/files/upload","stack":"MulterError: File too large\n    at abortWithCode (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:73:22)\n    at FileStream.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:136:11)\n    at FileStream.emit (node:events:508:28)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:479:32)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)\n    at writeOrBuffer (node:internal/streams/writable:570:12)\n    at _write (node:internal/streams/writable:499:10)\n    at Multipart.Writable.write (node:internal/streams/writable:508:10)"}
{"duration_ms":51,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/files/upload","status":500}
{"level":"info","message":"logout","userId":5}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"email":"editor@example.com","level":"info","message":"login_success","userId":4}
{"duration_ms":243,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/heartbeat","status":200}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/heartbeat","status":200}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:02:28.318Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:17:35.832Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":5}
{"duration_ms":246,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_verified","userId":5}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: table posts has no column named status","method":"POST","path":"/api/posts","stack":"Error: SQLITE_ERROR: table posts has no column named status"}
{"duration_ms":34,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":14,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:19:40.054Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error SQLITE_ERROR: no such column: status","method":"GET","path":"/api/posts","stack":"Error: SQLITE_ERROR: no such column: status\n--> in Database#all('SELECT * FROM posts WHERE status = ? ORDER BY created_at DESC', [ 'approved' ], [Function (anonymous)])\n    at /Users/user/Desktop/Security/backend/src/routes/posts.ts:135:6\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/route.js:149:13)\n    at requireAuth (/Users/user/Desktop/Security/backend/src/middleware/auth.ts:47:5)"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/api/posts","status":500}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:21:50.753Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":253,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_verified","userId":3}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"authorId":3,"hasImage":true,"level":"info","message":"post_created","postId":1,"status":"pending","title":"test test"}
{"duration_ms":41,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"email":"admin@example.com","level":"info","message":"login_success","userId":1}
{"duration_ms":250,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"info","message":"post_rejected","postId":1,"rejectedBy":1}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/1/reject","status":200}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"level":"info","message":"logout","userId":1}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":262,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_verified","userId":3}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"authorId":3,"hasImage":true,"level":"info","message":"post_created","postId":2,"status":"pending","title":"test 1"}
{"duration_ms":30,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"email":"admin@example.com","level":"warn","message":"login_failed","reason":"bad_password"}
{"duration_ms":250,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":401}
{"email":"admin@example.com","level":"info","message":"login_success","userId":1}
{"duration_ms":252,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"approvedBy":1,"level":"info","message":"post_approved","postId":2}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/2/approve","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:31:34.146Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:31:51.751Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"register","email":"test@chef.com","level":"info","message":"otp_generated","userId":4}
{"duration_ms":254,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/register","status":201}
{"email":"test@chef.com","level":"info","message":"otp_verified","userId":4}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"authorId":4,"hasImage":true,"level":"info","message":"post_created","postId":3,"status":"pending","title":"test"}
{"duration_ms":38,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"email":"admin@example.com","level":"info","message":"login_success","userId":1}
{"duration_ms":252,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":200}
{"duration_ms":12,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"level":"info","message":"post_rejected","postId":3,"rejectedBy":1}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/3/reject","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:36:47.679Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:44:58.559Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:47:02.537Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:47:32.390Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:49:09.608Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T19:52:27.718Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:05:43.619Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:06:18.120Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:06:38.714Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:07:32.817Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:08:49.785Z"}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":246,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_resent","userId":3}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/resend-otp","status":200}
{"description":"Regular User verified OTP and logged in","email":"user@example.com","level":"info","message":"otp_verified","name":"Regular User","userId":3}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"authorName":"Regular User","deletedBy":3,"deletedByName":"Regular User","description":"Regular User deleted post \"test 1\"","level":"info","message":"post_deleted","postId":2,"title":"test 1"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/2","status":204}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"authorId":3,"authorName":"Regular User","description":"Regular User created post \"homemade test\" (pending approval)","hasImage":true,"level":"info","message":"post_created","postId":4,"status":"pending","title":"homemade test"}
{"duration_ms":60,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":251,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"approvedBy":1,"approvedByName":"Admin User","description":"Admin User approved post \"homemade test\" by Regular User","level":"info","message":"post_approved","postAuthor":"Regular User","postId":4,"postTitle":"homemade test"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/4/approve","status":200}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":13,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":11,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":249,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_resent","userId":3}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/resend-otp","status":200}
{"description":"Regular User verified OTP and logged in","email":"user@example.com","level":"info","message":"otp_verified","name":"Regular User","userId":3}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"authorId":3,"authorName":"Regular User","description":"Regular User created post \"wdawd\" (pending approval)","hasImage":true,"level":"info","message":"post_created","postId":5,"status":"pending","title":"wdawd"}
{"duration_ms":39,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":249,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"approvedBy":1,"approvedByName":"Admin User","description":"Admin User approved post \"wdawd\" by Regular User","level":"info","message":"post_approved","postAuthor":"Regular User","postId":5,"postTitle":"wdawd"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/5/approve","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":15,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:18:29.731Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:25:11.831Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:25:24.260Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T21:26:05.907Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-03T22:28:56.512Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":249,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"description":"Regular User verified OTP and logged in","email":"user@example.com","level":"info","message":"otp_verified","name":"Regular User","userId":3}
{"duration_ms":12,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":79,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/image/2f439e2733a1be919230681e61a4d1eb.jpg","status":200}
{"duration_ms":86,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/image/671175181de6978b3c22340905d390e8.jpg","status":200}
{"authorName":"Regular User","deletedBy":3,"deletedByName":"Regular User","description":"Regular User deleted post \"homemade test\"","level":"info","message":"post_deleted","postId":4,"title":"homemade test"}
{"duration_ms":17,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/4","status":204}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":258,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":13,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"authorName":"Regular User","deletedBy":1,"deletedByName":"Admin User","description":"Admin User deleted post \"wdawd\" (by Regular User)","level":"info","message":"post_deleted","postId":5,"title":"wdawd"}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/5","status":204}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-04T12:05:08.355Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"action":"login","email":"user@example.com","level":"info","message":"otp_generated","userId":3}
{"duration_ms":258,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"email":"user@example.com","level":"info","message":"otp_resent","userId":3}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/resend-otp","status":200}
{"description":"Regular User verified OTP and logged in","email":"user@example.com","level":"info","message":"otp_verified","name":"Regular User","userId":3}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/verify-otp","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":200}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"authorId":3,"authorName":"Regular User","description":"Regular User created post \"test\" (pending approval)","hasImage":true,"level":"info","message":"post_created","postId":6,"status":"pending","title":"test"}
{"duration_ms":43,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":266,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":29,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/image/e47ee4ab85ad6adbd2b565da603dd4cf.jpg","status":200}
{"approvedBy":1,"approvedByName":"Admin User","description":"Admin User approved post \"test\" by Regular User","level":"info","message":"post_approved","postAuthor":"Regular User","postId":6,"postTitle":"test"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"PUT","path":"/6/approve","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"authorName":"Regular User","deletedBy":1,"deletedByName":"Admin User","description":"Admin User deleted post \"test\" (by Regular User)","level":"info","message":"post_deleted","postId":6,"title":"test"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/6","status":204}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":200}
{"action":"user_deleted","deletedBy":1,"deletedByName":"Admin User","deletedUserEmail":"test@chef.com","deletedUserId":4,"deletedUserName":"Chef test","description":"Admin \"Admin User\" deleted user \"Chef test\" (test@chef.com)","level":"info","message":"user_deleted"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/users/4","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":11,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T09:18:40.422Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":247,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":17,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"email":"hadirhimi9@gmail.com","level":"warn","message":"login_failed","reason":"user_not_found"}
{"duration_ms":17,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":401}
{"action":"register","email":"hadirhimi9@gmail.com","level":"info","message":"otp_generated","userId":5}
{"duration_ms":262,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/register","status":201}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/register","status":409}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":249,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":200}
{"action":"user_deleted","deletedBy":1,"deletedByName":"Admin User","deletedUserEmail":"hadirhimi9@gmail.com","deletedUserId":5,"deletedUserName":"ahdahdwd","description":"Admin \"Admin User\" deleted user \"ahdahdwd\" (hadirhimi9@gmail.com)","level":"info","message":"user_deleted"}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"DELETE","path":"/users/5","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":254,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":15,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":13,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/heartbeat","status":200}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/heartbeat","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/heartbeat","status":200}
{"description":"Admin User logged out","level":"info","message":"logout","userId":1,"userName":"Admin User"}
{"duration_ms":17,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/logout","status":204}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":259,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":11,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":7,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":8,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/users","status":304}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/logs","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/logout","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":10,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/logout","status":500}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:10:27.366Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:10:31.807Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:11:21.185Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:11:54.639Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:12:19.933Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:12:20.453Z"}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"description":"Admin User logged in","email":"admin@example.com","level":"info","message":"login_success","name":"Admin User","userId":1}
{"duration_ms":245,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/login","status":200}
{"duration_ms":0,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/me","status":200}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":9,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":6,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":4,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":3,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"level":"error","message":"server_error Only image files are allowed","method":"POST","path":"/api/posts","stack":"Error: Only image files are allowed\n    at fileFilter (/Users/user/Desktop/Security/backend/src/routes/posts.ts:39:10)\n    at wrappedFileFilter (/Users/user/Desktop/Security/backend/node_modules/multer/index.js:44:7)\n    at Multipart.<anonymous> (/Users/user/Desktop/Security/backend/node_modules/multer/lib/make-middleware.js:109:7)\n    at Multipart.emit (node:events:508:28)\n    at HeaderParser.cb (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:358:14)\n    at HeaderParser.push (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:162:20)\n    at SBMH.ssCb [as _cb] (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:394:37)\n    at feed (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:248:10)\n    at SBMH.push (/Users/user/Desktop/Security/backend/node_modules/streamsearch/lib/sbmh.js:104:16)\n    at Multipart._write (/Users/user/Desktop/Security/backend/node_modules/busboy/lib/types/multipart.js:567:19)"}
{"duration_ms":18,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/posts","status":500}
{"level":"error","message":"server_error invalid csrf token","method":"POST","path":"/api/auth/heartbeat","stack":"ForbiddenError: invalid csrf token\n    at csrf (/Users/user/Desktop/Security/backend/node_modules/csurf/index.js:112:19)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9\n    at router.process_params (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:346:12)\n    at next (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:280:10)\n    at requestLogger (/Users/user/Desktop/Security/backend/src/middleware/logging.ts:31:3)\n    at Layer.handle [as handle_request] (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/layer.js:95:5)\n    at trim_prefix (/Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:328:13)\n    at /Users/user/Desktop/Security/backend/node_modules/express/lib/router/index.js:286:9"}
{"duration_ms":5,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/api/auth/heartbeat","status":500}
{"authorId":1,"authorName":"Admin User","description":"Admin User created post \"imbuing\"","hasImage":true,"level":"info","message":"post_created","postId":7,"status":"approved","title":"imbuing"}
{"duration_ms":42,"ip":"::1","level":"info","message":"http_request","method":"POST","path":"/","status":201}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":200}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/pending","status":304}
{"duration_ms":1,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/list","status":304}
{"duration_ms":27,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/image/81b1244ffec656b8170d90cda2ff5420.jpg","status":200}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"duration_ms":2,"ip":"::1","level":"info","message":"http_request","method":"GET","path":"/","status":304}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:39.112Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:44.987Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:45.961Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:47.601Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:53.772Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:22:56.950Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:23:00.591Z"}
{"event":"server_init","level":"info","message":"Server initialized","timestamp":"2025-12-05T11:23:03.078Z"}
